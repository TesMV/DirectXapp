//-----------------------------------------------------------------------------
//
//  usbReferenceDevices.cs
//
//  WFF GenericHID Test Application (Version 4_0)
//  A test application for the WFF GenericHID Communication Library
//
//  Copyright (c) 2011 Simon Inns
//
//  Permission is hereby granted, free of charge, to any person obtaining a
//  copy of this software and associated documentation files (the "Software"),
//  to deal in the Software without restriction, including without limitation
//  the rights to use, copy, modify, merge, publish, distribute, sublicense,
//  and/or sell copies of the Software, and to permit persons to whom the
//  Software is furnished to do so, subject to the following conditions:
//
//  The above copyright notice and this permission notice shall be included in
//  all copies or substantial portions of the Software.
//
//  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
//  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
//  DEALINGS IN THE SOFTWARE.
//
//  Web:    http://www.waitingforfriday.com
//  Email:  simon.inns@gmail.com
//
//-----------------------------------------------------------------------------

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

// The following namespace allows debugging output (when compiled in debug mode)
using System.Diagnostics;

namespace DirectXApp
{
    using System.Threading;
    using WFF_GenericHID_Communication_Library;

    /// <summary>
    /// This class performs several different tests against the 
    /// reference hardware/firmware to confirm that the USB
    /// communication library is functioning correctly.
    /// 
    /// It also serves as a demonstration of how to use the class
    /// library to perform different types of read and write
    /// operations.
    /// </summary>
    class usbReferenceDevice : WFF_GenericHID_Communication_Library
        {


        public delegate void usbEventsHandlerDraw(ref double[,] mas, int maxindex);

        /// <summary>
        /// Define the event
        /// </summary>
        public event usbEventsHandlerDraw usbEventDraw;


        /// <summary>
        /// Class constructor - place any initialisation here
        /// </summary>
        /// <param name="vid"></param>
        /// <param name="pid"></param>
        public usbReferenceDevice(int vid, int pid) : base(vid, pid)
            {
            }

        //1562.5 Hz
        
        const int ORDERHPF=1;    //кол-во секций фильтра																	 
        //SOS matrix:                                                           
        double[,] SOSH=new double[ORDERHPF, 6]{
            { 1,   -2,  1 ,  1,   -1.99715655683131,   0.997160593680637}
                    };
                                                                      
        //Scale Factors:                                                        
        double[] ScaleFactorH=new double[ORDERHPF] {
            0.998579287627987
                           };


        const int BL_PB = 401;
        double[] B_PB = new double[BL_PB]{
  0.0004351842808772,0.0003750790438017,0.0003502111273514,0.0003701098499217,
  0.0004276967762878,0.0005071266764736,0.0005933249833373, 0.000678227922429,
  0.0007614644014634,0.0008467359201641,0.0009372364680966,  0.00103310730239,
   0.001131837134433, 0.001230381109141, 0.001326980550405, 0.001421441587222,
   0.001514080345682, 0.001604486322352, 0.001691121741764, 0.001771897171577,
   0.001845064709712, 0.001909651323138, 0.001965178104766, 0.002011041468101,
   0.002046144028051, 0.002069055979484, 0.002078499004557, 0.002073706324185,
   0.002054384241602, 0.002020378196339, 0.001971382934385, 0.001906951363084,
    0.00182676517783, 0.001730907790365, 0.001619908449074, 0.001494550842784,
   0.001355643233118, 0.001203956352063, 0.001040363680137, 0.000866035279231,
  0.0006825024094402,0.0004915400451136,0.0002949778861172,9.460070213737e-05,
  -0.0001077975190375,-0.0003102854636901,-0.0005107326720603,-0.0007068847340489,
  -0.0008965196497214,-0.001077563011915,-0.001248087325312,-0.001406230854389,
  -0.001550140815466,-0.001678015724795,-0.001788226680384, -0.00187942713345,
  -0.001950576322326,-0.002000882816797,-0.002029744027087,-0.002036753606784,
  -0.002021779972541,-0.001985051824305, -0.00192718112458,-0.001849111408164,
  -0.001752043848672,-0.001637406576949,-0.001506885741868,-0.001362475860865,
  -0.001206488092314,-0.001041492887023,-0.0008702306122981,-0.0006955474199863,
  -0.0005203843146106,-0.0003477945990161,-0.0001809378187678,-2.302022915017e-05,
  0.0001227997286389,0.0002534927802421,0.0003661939321939,0.0004582021582566,
  0.0005269867868532,0.0005702335759668, 0.000585924111995,0.0005724098746801,
  0.0005284461787896,0.0004531860766511,0.0003461670223463,0.0002073239560217,
  3.703212880821e-05,-0.000163849451755,-0.0003939678507347,-0.000651507048407,
  -0.0009342355524269,-0.001239538110132, -0.00156442065074,-0.001905508390166,
  -0.002259068226596,-0.002621068575879,-0.002987260125867, -0.00335324714344,
  -0.003714532953933,-0.004066551124745,-0.004404709583791,-0.004724464383415,
  -0.005021413596564,-0.005291384445759,-0.005530493819061,-0.005735186500603,
  -0.005902273981028,-0.006028992798001,-0.006113079328189,-0.006152838635878,
  -0.006147186061824,-0.006095660129284,-0.005998425264917,-0.005856284557583,
  -0.005670705354839,-0.005443840594328,-0.005178524846369,-0.004878239352895,
   -0.00454706037863,-0.004189611512586,-0.003811027859686,-0.003416920663402,
   -0.00301332294429,-0.002606607357207,-0.002203386518291,-0.001810415893308,
  -0.001434511251814,-0.001082474663852,-0.0007610119712392,-0.000476630670776,
  -0.0002355243173337,-4.346185493659e-05,9.430347330355e-05,0.0001731069563775,
  0.0001889415045861,0.0001385358594128,1.944016970349e-05,-0.0001698965944318,
  -0.0004300731033329,-0.0007607083456222, -0.00116042844425,-0.001626853274021,
  -0.002156580161267,-0.002745176318568,-0.003387195341677,-0.004076222736491,
  -0.004804940716266,-0.005565196925387,-0.006348070134839,-0.007143940168289,
  -0.007942575979732, -0.00873324874273,-0.009504862633171, -0.01024608776733,
   -0.01094548486837, -0.01159162463757, -0.01217321389879, -0.01267923695344,
   -0.01309910770972, -0.01342281802149, -0.01364106958594, -0.01374538876777,
   -0.01372823461238, -0.01358311006087, -0.01330467541644, -0.01288885178272,
    -0.0123329010754, -0.01163547932747, -0.01079667200385,-0.009818022939674,
  -0.008702559891344,-0.007454807812427, -0.00608077703985,-0.004587921340425,
  -0.002985073113251,-0.001282368689409,0.0005088293604012, 0.002376017833222,
   0.004305657784254, 0.006283305021454, 0.008293760583463,   0.0103212277042,
    0.01234946508824,  0.01436193756337,  0.01634197376323,  0.01827293839375,
    0.02013841579082,  0.02192239194505,  0.02360942276184,  0.02518478644643,
    0.02663462814477,  0.02794610587378,  0.02910753760354,  0.03010853874084,
    0.03094013717561,  0.03159486152993,  0.03206680954253,  0.03235170729504,
    0.03244696292064,  0.03235170729504,  0.03206680954253,  0.03159486152993,
    0.03094013717561,  0.03010853874084,  0.02910753760354,  0.02794610587378,
    0.02663462814477,  0.02518478644643,  0.02360942276184,  0.02192239194505,
    0.02013841579082,  0.01827293839375,  0.01634197376323,  0.01436193756337,
    0.01234946508824,   0.0103212277042, 0.008293760583463, 0.006283305021454,
   0.004305657784254, 0.002376017833222,0.0005088293604012,-0.001282368689409,
  -0.002985073113251,-0.004587921340425, -0.00608077703985,-0.007454807812427,
  -0.008702559891344,-0.009818022939674, -0.01079667200385, -0.01163547932747,
    -0.0123329010754, -0.01288885178272, -0.01330467541644, -0.01358311006087,
   -0.01372823461238, -0.01374538876777, -0.01364106958594, -0.01342281802149,
   -0.01309910770972, -0.01267923695344, -0.01217321389879, -0.01159162463757,
   -0.01094548486837, -0.01024608776733,-0.009504862633171, -0.00873324874273,
  -0.007942575979732,-0.007143940168289,-0.006348070134839,-0.005565196925387,
  -0.004804940716266,-0.004076222736491,-0.003387195341677,-0.002745176318568,
  -0.002156580161267,-0.001626853274021, -0.00116042844425,-0.0007607083456222,
  -0.0004300731033329,-0.0001698965944318,1.944016970349e-05,0.0001385358594128,
  0.0001889415045861,0.0001731069563775,9.430347330355e-05,-4.346185493659e-05,
  -0.0002355243173337,-0.000476630670776,-0.0007610119712392,-0.001082474663852,
  -0.001434511251814,-0.001810415893308,-0.002203386518291,-0.002606607357207,
   -0.00301332294429,-0.003416920663402,-0.003811027859686,-0.004189611512586,
   -0.00454706037863,-0.004878239352895,-0.005178524846369,-0.005443840594328,
  -0.005670705354839,-0.005856284557583,-0.005998425264917,-0.006095660129284,
  -0.006147186061824,-0.006152838635878,-0.006113079328189,-0.006028992798001,
  -0.005902273981028,-0.005735186500603,-0.005530493819061,-0.005291384445759,
  -0.005021413596564,-0.004724464383415,-0.004404709583791,-0.004066551124745,
  -0.003714532953933, -0.00335324714344,-0.002987260125867,-0.002621068575879,
  -0.002259068226596,-0.001905508390166, -0.00156442065074,-0.001239538110132,
  -0.0009342355524269,-0.000651507048407,-0.0003939678507347,-0.000163849451755,
  3.703212880821e-05,0.0002073239560217,0.0003461670223463,0.0004531860766511,
  0.0005284461787896,0.0005724098746801, 0.000585924111995,0.0005702335759668,
  0.0005269867868532,0.0004582021582566,0.0003661939321939,0.0002534927802421,
  0.0001227997286389,-2.302022915017e-05,-0.0001809378187678,-0.0003477945990161,
  -0.0005203843146106,-0.0006955474199863,-0.0008702306122981,-0.001041492887023,
  -0.001206488092314,-0.001362475860865,-0.001506885741868,-0.001637406576949,
  -0.001752043848672,-0.001849111408164, -0.00192718112458,-0.001985051824305,
  -0.002021779972541,-0.002036753606784,-0.002029744027087,-0.002000882816797,
  -0.001950576322326, -0.00187942713345,-0.001788226680384,-0.001678015724795,
  -0.001550140815466,-0.001406230854389,-0.001248087325312,-0.001077563011915,
  -0.0008965196497214,-0.0007068847340489,-0.0005107326720603,-0.0003102854636901,
  -0.0001077975190375,9.460070213737e-05,0.0002949778861172,0.0004915400451136,
  0.0006825024094402, 0.000866035279231, 0.001040363680137, 0.001203956352063,
   0.001355643233118, 0.001494550842784, 0.001619908449074, 0.001730907790365,
    0.00182676517783, 0.001906951363084, 0.001971382934385, 0.002020378196339,
   0.002054384241602, 0.002073706324185, 0.002078499004557, 0.002069055979484,
   0.002046144028051, 0.002011041468101, 0.001965178104766, 0.001909651323138,
   0.001845064709712, 0.001771897171577, 0.001691121741764, 0.001604486322352,
   0.001514080345682, 0.001421441587222, 0.001326980550405, 0.001230381109141,
   0.001131837134433,  0.00103310730239,0.0009372364680966,0.0008467359201641,
  0.0007614644014634, 0.000678227922429,0.0005933249833373,0.0005071266764736,
  0.0004276967762878,0.0003701098499217,0.0003502111273514,0.0003750790438017,
  0.0004351842808772
};



        const int BL_LPF = 792;
        double[] B_LPF = new double[BL_LPF]{
 6.803144344386e-05,2.293061099064e-05,2.620712798891e-05,2.940811189102e-05,
  3.235728772466e-05,3.501613570036e-05,3.716280030156e-05,3.871810327039e-05,
  3.943608149987e-05,3.924193917048e-05, 3.78906935006e-05,3.528543021888e-05,
  3.111737879325e-05,2.527529097549e-05,1.751000362918e-05, 7.79849514569e-06,
  -4.29461226419e-06,-1.873512229753e-05,-3.577551783589e-05,-5.555787031849e-05,
   -7.8187514486e-05,-0.0001037604081889,-0.0001323667039565,-0.0001640337233254,
  -0.0001988086384106,-0.000236629750846,-0.0002774708491416,-0.0003212051012896,
  -0.0003677426128618,-0.0004168532708749,-0.0004683464105929,-0.0005219382326603,
  -0.0005773430805123,-0.000634151356648,-0.0006920578850462,-0.0007505473186955,
  -0.0008092344011857,-0.0008675528185896,-0.0009250460006235,-0.0009811141332695,
  -0.001035251143546,-0.001086826904137,-0.001135321220454,-0.001180106781345,
   -0.00122066423978,-0.001256391007168,-0.001286821477171,-0.001311402607168,
  -0.001329718245222,-0.001341324756809,-0.001345894160887,-0.001343089159143,
  -0.001332716981199,-0.001314564881636, -0.00128859537216,-0.001254745509093,
  -0.001213138489982,-0.001163883580594,-0.001107275806868,-0.001043590590478,
  -0.0009732933389519,-0.0008968378739462,-0.0008148496093767,-0.000727930922267,
  -0.0006368640511163,-0.0005423814856965,-0.000445378438902,-0.0003467002487722,
  -0.0002473183703605,-0.0001481501799002,-5.020619903244e-05,4.557718668073e-05,
  0.0001381873390667,0.0002267128782977,0.0003101953860349,0.0003877986248539,
  0.0004586585118231, 0.000522063984737,0.0005772995716658,0.0006238125120039,
  0.0006610744326721,0.0006887391187876, 0.000706490393443,0.0007142165783251,
   0.000711837089455,0.0006994869962832,0.0006773396274581, 0.000645774805256,
  0.0006052142060719,0.0005562782225788,0.0004996185742788,0.0004360672422863,
  0.0003664791052897,0.0002918678266211,0.0002132421837003, 0.000131748286093,
  4.850292228991e-05,-3.527644617719e-05,  -0.0001184246628,-0.0001997145841626,
  -0.0002780016004263,-0.0003521093483897,-0.000420984406675,-0.0004835678830858,
  -0.0005389546734046,-0.000586265959383,-0.0006248060253423,-0.0006539265472312,
  -0.0006731837712633,-0.0006822047563649,-0.0006808315921825,-0.0006689882901227,
  -0.0006468239897313,-0.0006145688021817,-0.0005726780162212,-0.0005216815420602,
  -0.0004623188506764,-0.0003953972088241,-0.0003219075632417,-0.0002428856623424,
  -0.0001595247839118,-7.303312199183e-05,1.526004507392e-05,0.0001040464335969,
  0.0001919319606233,0.0002775863205166,0.0003596348655348, 0.000436805091314,
  0.0005078235953472,0.0005715568537542,0.0006269094618559,0.0006729654289003,
  0.0007088748215527,0.0007340009214435,0.0007478006204104,0.0007499623790102,
  0.0007402878925368,0.0007188228351568,0.0006857348047196,0.0006414330872569,
  0.0005864482484832,0.0005215420739292,0.0004475821293768,0.0003656472308264,
  0.0002768959108345,0.0001826662873805,8.434461693154e-05,-1.654782371819e-05,
  -0.0001184802832261,-0.0002198318283752,-0.0003190227945779,-0.0004144313126881,
  -0.0005045261558524,-0.0005877840036344,-0.0006628225071651,-0.0007283142914306,
  -0.0007831173075944,-0.0008261889120134,-0.0008567081507082,-0.0008739893611328,
  -0.000877596145069,-0.000867250271067,-0.0008429424811411,-0.0008048319636847,
  -0.0007533479718038,-0.0006890905402747,-0.0006129166705337,-0.0005258392429777,
  -0.0004291037407814,-0.0003240838921258,-0.0002123484363855,-9.555329785609e-05,
  2.449709409691e-05,0.0001459619027022,0.0002669066334672,0.0003854178501667,
  0.0004995502391662,0.0006074372200415,0.0007072435331144,0.0007972738963836,
  0.0008759205015905,0.0009417726858173,0.0009935608057029, 0.001030258733102,
   0.001051024867796, 0.001055296433816, 0.001042726899415, 0.001013269113962,
  0.0009671084409348,0.0009047341409379,0.0008268676651365,0.0007345232455035,
  0.0006289274961963,0.0005115725874092,0.0003841299650059,0.0002484898913923,
  0.0001066739336907,-3.913426317926e-05,-0.0001866821288617,-0.0003336219230339,
  -0.0004776075132338,-0.0006162706143731,-0.0007473194467337,-0.0008685154317513,
  -0.0009777707789721, -0.00107312305818,-0.001152829062175,-0.001215338021807,
  -0.001259376114524,-0.001283914538866,-0.001288248344336,-0.001271954527995,
  -0.001234960910507,-0.001177497726573,-0.001100153234813,-0.001003817469953,
  -0.0008897248440852,-0.0007593896814409,-0.0006146371605829,-0.0004575299753177,
  -0.0002903880290529,-0.000115707381918,6.382690160876e-05,0.0002454309077663,
  0.0004262147022194,0.0006032747182515,0.0007736928277065,0.0009346301768992,
   0.001083325553466, 0.001217189554775, 0.001333799898523, 0.001430992425409,
   0.001506851127596, 0.001559791503559, 0.001588543757248, 0.001592226545788,
   0.001570320813155,  0.00152272994199, 0.001449745282597, 0.001352091942535,
    0.00123088059491, 0.001087641564721,0.0009242640138865,0.0007430152826069,
  0.0005464695296785,0.0003375135926346,0.0001192659275375,-0.0001049281398504,
  -0.0003315868150319, -0.00055710328233,-0.0007778421823027,-0.0009901556577404,
   -0.00119048382599,-0.001375369627909, -0.00154155893582,-0.001686014641008,
  -0.001806009734049,-0.001899136118502,-0.001963389975901,-0.001997170242377,
   -0.00199935311081,-0.001969277827548,-0.001906806828747,-0.001812298717822,
  -0.001686650700301,-0.001531256482399,-0.001348031844392,-0.001139357509828,
  -0.0009080865138347,-0.0006574719322608,-0.0003911606697216,-0.0001131050132349,
  0.0001724557818996,0.0004610946823771,0.0007482260333352, 0.001029212055132,
    0.00129939861243, 0.001554226054118, 0.001789264980053, 0.002000328278976,
   0.002183503537991, 0.002335259465835, 0.002452470787206, 0.002532515750053,
   0.002573289390837,  0.00257328543585, 0.002531596220172, 0.002447976798984,
   0.002322825980944, 0.002157231626459, 0.001952930722874, 0.001712334282689,
   0.001438466877147, 0.001134969126356,0.0008060183188612,0.0004563112370901,
  9.096487684437e-05,-0.0002845170214833,-0.0006643587626365,-0.001042559158475,
  -0.001413019412763,-0.001769596715918,-0.002106239083466,-0.002417042846826,
  -0.002696387673819,-0.002938992165269,-0.003140043462549,-0.003295244337064,
  -0.003400933224786,-0.003454116220773,-0.003452570352069,-0.003394858382848,
  -0.003280409951934,-0.003109513547073,-0.002883372957241,-0.002604074336879,
  -0.002274614825022,-0.001898842454194,-0.001481457868591,-0.001027926555974,
  -0.0005444543235117,-3.787351698518e-05,0.0004844056292922, 0.001014529951428,
   0.001544272954098, 0.002065187725573, 0.002568689658285, 0.003046221846577,
   0.003489346397512, 0.003889913739625, 0.004240154981649, 0.004532848557449,
   0.004761406685382, 0.004920030666971, 0.005003784240446,  0.00500873020665,
   0.004931984239159, 0.004771826298267, 0.004527727703586, 0.004200432905745,
   0.003791956099052,  0.00330562721315,  0.00274605535418, 0.002119138804118,
   0.001431992417258,0.0006929208445952,-8.86884324718e-05,-0.0009024268959364,
   -0.00173700411563,-0.002580340818126,-0.003419735655867,-0.004241983466806,
  -0.005033563630627,-0.005780777853489,-0.006469950744971,-0.007087578489195,
   -0.00762053468766, -0.00805622065259,-0.008382765502451,-0.008589170081015,
  -0.008665492390578, -0.00860297492948,-0.008394206709063,-0.008033226026811,
  -0.007515651039781,-0.006838750777177,-0.006001536767274,-0.005004796893803,
  -0.003851144926984,-0.002545011443048,-0.001092648476589,0.0004979225134692,
   0.002216952032256, 0.004053057964607, 0.005993310106771, 0.008023365433701,
    0.01012759274713,  0.01228924266005,  0.01449060577833,  0.01671321013716,
    0.01893800485931,   0.0211455772377,  0.02331635239471,  0.02543081846819,
    0.02746973422473,  0.02941435169064,  0.03124661925546,  0.03294939241959,
     0.0345066226359,  0.03590354526468,  0.03712684392928,  0.03816480719452,
    0.03900746017607,  0.03964668202815,  0.04007629771955,   0.0402921506805,
     0.0402921506805,  0.04007629771955,  0.03964668202815,  0.03900746017607,
    0.03816480719452,  0.03712684392928,  0.03590354526468,   0.0345066226359,
    0.03294939241959,  0.03124661925546,  0.02941435169064,  0.02746973422473,
    0.02543081846819,  0.02331635239471,   0.0211455772377,  0.01893800485931,
    0.01671321013716,  0.01449060577833,  0.01228924266005,  0.01012759274713,
   0.008023365433701, 0.005993310106771, 0.004053057964607, 0.002216952032256,
  0.0004979225134692,-0.001092648476589,-0.002545011443048,-0.003851144926984,
  -0.005004796893803,-0.006001536767274,-0.006838750777177,-0.007515651039781,
  -0.008033226026811,-0.008394206709063, -0.00860297492948,-0.008665492390578,
  -0.008589170081015,-0.008382765502451, -0.00805622065259, -0.00762053468766,
  -0.007087578489195,-0.006469950744971,-0.005780777853489,-0.005033563630627,
  -0.004241983466806,-0.003419735655867,-0.002580340818126, -0.00173700411563,
  -0.0009024268959364,-8.86884324718e-05,0.0006929208445952, 0.001431992417258,
   0.002119138804118,  0.00274605535418,  0.00330562721315, 0.003791956099052,
   0.004200432905745, 0.004527727703586, 0.004771826298267, 0.004931984239159,
    0.00500873020665, 0.005003784240446, 0.004920030666971, 0.004761406685382,
   0.004532848557449, 0.004240154981649, 0.003889913739625, 0.003489346397512,
   0.003046221846577, 0.002568689658285, 0.002065187725573, 0.001544272954098,
   0.001014529951428,0.0004844056292922,-3.787351698518e-05,-0.0005444543235117,
  -0.001027926555974,-0.001481457868591,-0.001898842454194,-0.002274614825022,
  -0.002604074336879,-0.002883372957241,-0.003109513547073,-0.003280409951934,
  -0.003394858382848,-0.003452570352069,-0.003454116220773,-0.003400933224786,
  -0.003295244337064,-0.003140043462549,-0.002938992165269,-0.002696387673819,
  -0.002417042846826,-0.002106239083466,-0.001769596715918,-0.001413019412763,
  -0.001042559158475,-0.0006643587626365,-0.0002845170214833,9.096487684437e-05,
  0.0004563112370901,0.0008060183188612, 0.001134969126356, 0.001438466877147,
   0.001712334282689, 0.001952930722874, 0.002157231626459, 0.002322825980944,
   0.002447976798984, 0.002531596220172,  0.00257328543585, 0.002573289390837,
   0.002532515750053, 0.002452470787206, 0.002335259465835, 0.002183503537991,
   0.002000328278976, 0.001789264980053, 0.001554226054118,  0.00129939861243,
   0.001029212055132,0.0007482260333352,0.0004610946823771,0.0001724557818996,
  -0.0001131050132349,-0.0003911606697216,-0.0006574719322608,-0.0009080865138347,
  -0.001139357509828,-0.001348031844392,-0.001531256482399,-0.001686650700301,
  -0.001812298717822,-0.001906806828747,-0.001969277827548, -0.00199935311081,
  -0.001997170242377,-0.001963389975901,-0.001899136118502,-0.001806009734049,
  -0.001686014641008, -0.00154155893582,-0.001375369627909, -0.00119048382599,
  -0.0009901556577404,-0.0007778421823027, -0.00055710328233,-0.0003315868150319,
  -0.0001049281398504,0.0001192659275375,0.0003375135926346,0.0005464695296785,
  0.0007430152826069,0.0009242640138865, 0.001087641564721,  0.00123088059491,
   0.001352091942535, 0.001449745282597,  0.00152272994199, 0.001570320813155,
   0.001592226545788, 0.001588543757248, 0.001559791503559, 0.001506851127596,
   0.001430992425409, 0.001333799898523, 0.001217189554775, 0.001083325553466,
  0.0009346301768992,0.0007736928277065,0.0006032747182515,0.0004262147022194,
  0.0002454309077663,6.382690160876e-05,-0.000115707381918,-0.0002903880290529,
  -0.0004575299753177,-0.0006146371605829,-0.0007593896814409,-0.0008897248440852,
  -0.001003817469953,-0.001100153234813,-0.001177497726573,-0.001234960910507,
  -0.001271954527995,-0.001288248344336,-0.001283914538866,-0.001259376114524,
  -0.001215338021807,-0.001152829062175, -0.00107312305818,-0.0009777707789721,
  -0.0008685154317513,-0.0007473194467337,-0.0006162706143731,-0.0004776075132338,
  -0.0003336219230339,-0.0001866821288617,-3.913426317926e-05,0.0001066739336907,
  0.0002484898913923,0.0003841299650059,0.0005115725874092,0.0006289274961963,
  0.0007345232455035,0.0008268676651365,0.0009047341409379,0.0009671084409348,
   0.001013269113962, 0.001042726899415, 0.001055296433816, 0.001051024867796,
   0.001030258733102,0.0009935608057029,0.0009417726858173,0.0008759205015905,
  0.0007972738963836,0.0007072435331144,0.0006074372200415,0.0004995502391662,
  0.0003854178501667,0.0002669066334672,0.0001459619027022,2.449709409691e-05,
  -9.555329785609e-05,-0.0002123484363855,-0.0003240838921258,-0.0004291037407814,
  -0.0005258392429777,-0.0006129166705337,-0.0006890905402747,-0.0007533479718038,
  -0.0008048319636847,-0.0008429424811411,-0.000867250271067,-0.000877596145069,
  -0.0008739893611328,-0.0008567081507082,-0.0008261889120134,-0.0007831173075944,
  -0.0007283142914306,-0.0006628225071651,-0.0005877840036344,-0.0005045261558524,
  -0.0004144313126881,-0.0003190227945779,-0.0002198318283752,-0.0001184802832261,
  -1.654782371819e-05,8.434461693154e-05,0.0001826662873805,0.0002768959108345,
  0.0003656472308264,0.0004475821293768,0.0005215420739292,0.0005864482484832,
  0.0006414330872569,0.0006857348047196,0.0007188228351568,0.0007402878925368,
  0.0007499623790102,0.0007478006204104,0.0007340009214435,0.0007088748215527,
  0.0006729654289003,0.0006269094618559,0.0005715568537542,0.0005078235953472,
   0.000436805091314,0.0003596348655348,0.0002775863205166,0.0001919319606233,
  0.0001040464335969,1.526004507392e-05,-7.303312199183e-05,-0.0001595247839118,
  -0.0002428856623424,-0.0003219075632417,-0.0003953972088241,-0.0004623188506764,
  -0.0005216815420602,-0.0005726780162212,-0.0006145688021817,-0.0006468239897313,
  -0.0006689882901227,-0.0006808315921825,-0.0006822047563649,-0.0006731837712633,
  -0.0006539265472312,-0.0006248060253423,-0.000586265959383,-0.0005389546734046,
  -0.0004835678830858,-0.000420984406675,-0.0003521093483897,-0.0002780016004263,
  -0.0001997145841626,  -0.0001184246628,-3.527644617719e-05,4.850292228991e-05,
   0.000131748286093,0.0002132421837003,0.0002918678266211,0.0003664791052897,
  0.0004360672422863,0.0004996185742788,0.0005562782225788,0.0006052142060719,
   0.000645774805256,0.0006773396274581,0.0006994869962832, 0.000711837089455,
  0.0007142165783251, 0.000706490393443,0.0006887391187876,0.0006610744326721,
  0.0006238125120039,0.0005772995716658, 0.000522063984737,0.0004586585118231,
  0.0003877986248539,0.0003101953860349,0.0002267128782977,0.0001381873390667,
  4.557718668073e-05,-5.020619903244e-05,-0.0001481501799002,-0.0002473183703605,
  -0.0003467002487722,-0.000445378438902,-0.0005423814856965,-0.0006368640511163,
  -0.000727930922267,-0.0008148496093767,-0.0008968378739462,-0.0009732933389519,
  -0.001043590590478,-0.001107275806868,-0.001163883580594,-0.001213138489982,
  -0.001254745509093, -0.00128859537216,-0.001314564881636,-0.001332716981199,
  -0.001343089159143,-0.001345894160887,-0.001341324756809,-0.001329718245222,
  -0.001311402607168,-0.001286821477171,-0.001256391007168, -0.00122066423978,
  -0.001180106781345,-0.001135321220454,-0.001086826904137,-0.001035251143546,
  -0.0009811141332695,-0.0009250460006235,-0.0008675528185896,-0.0008092344011857,
  -0.0007505473186955,-0.0006920578850462,-0.000634151356648,-0.0005773430805123,
  -0.0005219382326603,-0.0004683464105929,-0.0004168532708749,-0.0003677426128618,
  -0.0003212051012896,-0.0002774708491416,-0.000236629750846,-0.0001988086384106,
  -0.0001640337233254,-0.0001323667039565,-0.0001037604081889, -7.8187514486e-05,
  -5.555787031849e-05,-3.577551783589e-05,-1.873512229753e-05,-4.29461226419e-06,
   7.79849514569e-06,1.751000362918e-05,2.527529097549e-05,3.111737879325e-05,
  3.528543021888e-05, 3.78906935006e-05,3.924193917048e-05,3.943608149987e-05,
  3.871810327039e-05,3.716280030156e-05,3.501613570036e-05,3.235728772466e-05,
  2.940811189102e-05,2.620712798891e-05,2.293061099064e-05,6.803144344386e-05
};

        const int BL_HPF = 2259;
        double[] B_HPF = new double[BL_HPF]{
   0.002103942351359,3.897181528051e-05,3.929890490342e-05, 3.96911713349e-05,
  4.004530705363e-05,4.042505820919e-05,  4.0806699088e-05,4.117364318028e-05,
  4.158103930553e-05,4.193626313007e-05,4.236910196355e-05, 4.27107201847e-05,
  4.316780248113e-05,4.349490070301e-05,4.397390124178e-05,4.428638695313e-05,
  4.478448516011e-05,4.507990550255e-05,4.559334179272e-05,4.586950399238e-05,
  4.639389229941e-05, 4.66488454305e-05,4.717897595793e-05,4.740936863215e-05,
  4.793977872207e-05, 4.81440917511e-05,4.866949490222e-05,4.884885197167e-05,
   4.93646360147e-05,4.952357314095e-05,5.002846018464e-05,5.018291904661e-05,
  5.068045515006e-05,5.086660354889e-05,5.136966486722e-05, 5.16646808791e-05,
  5.220363144118e-05,5.281422056617e-05,5.343529252525e-05, 5.54944805898e-05,
  5.383985234492e-05,5.343918595928e-05,5.524884175831e-05,5.474311746044e-05,
   5.59509352733e-05,5.561574515887e-05,5.670978146589e-05,5.643424188702e-05,
  5.749146453531e-05, 5.72409620464e-05,5.828691995329e-05,5.804656760468e-05,
  5.909508976116e-05, 5.88568107182e-05,5.991670439206e-05,5.967538645899e-05,
  6.075019216093e-05,6.050203740359e-05,6.159411906067e-05,6.133527558706e-05,
  6.244508939128e-05,6.217067629078e-05,6.329570548482e-05,6.300063588913e-05,
  6.413865019298e-05,6.381738608382e-05,6.496648166621e-05,6.461426257708e-05,
  6.577439697591e-05,6.539128406098e-05,6.657088278154e-05,6.616313451099e-05,
  6.738202765226e-05,6.696526262697e-05,6.825625166294e-05,6.785198757457e-05,
  6.926002158129e-05,6.884546692568e-05, 7.03882844732e-05,6.947016879659e-05,
  7.051052826833e-05,7.062198853417e-05,7.162629364714e-05,7.132651947411e-05,
  7.251146318779e-05,7.213044102813e-05,7.337255252431e-05,7.294661625373e-05,
  7.422565826511e-05,7.376494242229e-05,7.507441882774e-05,7.458585404813e-05,
  7.592275034493e-05,7.541106862521e-05,7.677392755813e-05,7.624064579163e-05,
  7.762918482045e-05,7.707596362457e-05,7.848901943134e-05, 7.79156176911e-05,
  7.935051597821e-05,7.875414536189e-05,8.020782698126e-05,7.958578184696e-05,
  8.105392460079e-05,  8.0403198027e-05, 8.18824682247e-05,8.120221271569e-05,
  8.269467272714e-05,8.199135220173e-05,8.350446869378e-05,8.279142765851e-05,
  8.433869582424e-05,8.363026329652e-05,8.522114959405e-05,8.451561202095e-05,
  8.611608603536e-05,8.535183642769e-05,8.682318281377e-05,8.588893986625e-05,
  8.785463392847e-05,8.685577012482e-05,8.855217786066e-05,8.767872214613e-05,
  8.936632289796e-05,8.848075410638e-05,9.017936204367e-05,8.927530388421e-05,
  9.098695114485e-05,9.006335096592e-05,9.179136515351e-05,9.084763780428e-05,
  9.259432375711e-05,9.163077121538e-05,9.339667568483e-05,9.241481977085e-05,
  9.420129478851e-05,9.320102619107e-05,9.500750715429e-05,9.398721125078e-05,
  9.581114793071e-05,9.476875303341e-05,9.660745604916e-05,9.553912172818e-05,
  9.738954076834e-05, 9.62930588528e-05,9.815489812161e-05,9.703352519333e-05,
  9.891256365315e-05,9.777326436565e-05,9.967863518121e-05,9.853062109103e-05,
  0.0001004661257575,9.930924489977e-05,0.0001012591425556,0.0001000638551802,
  0.0001019864254993,  0.00010072646613, 0.000102639287742,0.0001015907532434,
  0.0001034843197503,0.0001021986908753,0.0001042403987567,0.0001029266820006,
   0.000104970253698,0.0001036391422706,0.0001056936589833,0.0001043397989684,
  0.0001064081930989,0.0001050321415008,0.0001071149996527,0.0001057172144683,
  0.0001078158308043,0.0001063962825249,0.0001085130589259,0.0001070727678084,
  0.0001092077737097, 0.000107745977517,0.0001098981089735,0.0001084126092966,
  0.0001105801888995,0.0001090684219976,0.0001112478589075,0.0001097072888344,
  0.0001118974811405, 0.000110328766715,0.0001125335479127,0.0001109418459992,
  0.0001131666503668,0.0001115576072964, 0.000113807007565,0.0001121781919263,
  0.0001144463301933,0.0001127812306799,0.0001150482168927, 0.000113331706284,
  0.0001156100510599,0.0001138837428325,0.0001162873555103,0.0001145040864406,
  0.0001167692263994,0.0001150730216607,0.0001173623938319,0.0001156058860242,
  0.0001179253426871,0.0001161337541081,0.0001184703689795,0.0001166491770394,
  0.0001190018626134,0.0001171519492887,0.0001195201788499,0.0001176434639606,
   0.000120027120242, 0.000118126310467,0.0001205261948355,0.0001186011663975,
  0.0001210165669565,0.0001190665835828,0.0001214957157831,0.0001195192980958,
  0.0001219598348071,0.0001199538492494,0.0001224041509771,0.0001203687531172,
  0.0001228303614716, 0.000120769516778,0.0001232466271862,0.0001211638184716,
  0.0001236590088925, 0.000121554956165,0.0001240625391213,0.0001219294853363,
  0.0001244375656516,0.0001222657611276,0.0001247772955322,0.0001225889714058,
  0.0001251370370148,0.0001229666351269,0.0001254984742316,0.0001232004642845,
  0.0001258353211345,0.0001235290474266,0.0001261263676207,0.0001238160546317,
  0.0001264157893872,0.0001240808941657,0.0001266891231211,0.0001243285480732,
  0.0001269453725152,0.0001245585866647,0.0001271860117678,0.0001247731998863,
  0.0001274135293376,0.0001249753926407,0.0001276279440108,0.0001251640299069,
  0.0001278281752167,0.0001253370620786,0.0001280112605013,0.0001254909704569,
  0.0001281726564907,0.0001256226446315,0.0001283130310253, 0.000125735367855,
  0.0001284379071838,0.0001258354860204,0.0001285514810015,0.0001259243851592,
  0.0001286518065872,0.0001259933859666,0.0001287252259818,0.0001260296699773,
  0.0001287641727651,0.0001260430407869,0.0001287997339097,0.0001260698266847,
  0.0001288465328997,0.0001260639686185,0.0001287911230249,0.0001260498943704,
  0.0001288072104801,0.0001259806945895,0.0001287731655975, 0.000125912780296,
  0.0001287126138984,0.0001258231767918,0.0001286311251506,0.0001257110971601,
  0.0001285273503739,0.0001255785258363,0.0001284036170681,0.0001254275224741,
  0.0001282620150229,0.0001252574425249,0.0001281011396514, 0.000125067574329,
   0.000127919184723,0.0001248551095646,0.0001277130409519,0.0001246167879567,
  0.0001274815124837,0.0001243551875268, 0.000127228742626,0.0001240749452302,
  0.0001269586990148,0.0001237768992361, 0.000126669150544,0.0001234560443178,
  0.0001263507696256,0.0001231017780129, 0.000125998523802,0.0001227169683244,
  0.0001256286645698,0.0001223270897484,0.0001252560766687,0.0001219193482426,
  0.0001248360488518,0.0001214410737466,0.0001244149940345,0.0001210076669011,
  0.0001239313483816,0.0001205193863994,0.0001234508711604,0.0001200005236258,
  0.0001229417701137, 0.000119457750114,0.0001224048598804,0.0001188886560065,
  0.0001218430338981,0.0001182955059157,0.0001212576880214,0.0001176793740527,
  0.0001206477483328, 0.000117038781271,0.0001200128907147,0.0001163720545007,
  0.0001193504812523,0.0001156768122222,0.0001186588851985,0.0001149538064152,
  0.0001179420518004,0.0001142072061058,  0.00011720303018,0.0001134384873581,
  0.0001164399606946,0.0001126432248627,0.0001156469031412,0.0001118136695652,
  0.0001148177645211,0.0001109513470627,0.0001139611376261,0.0001100716612987,
  0.0001130923285937,0.0001091729558804,0.0001121887617536,0.0001082245933709,
  0.0001112374832801,0.0001072757827703,0.0001103050338401, 0.000106260537822,
  0.0001093174820916,0.0001052494349242,0.0001082960137196,0.0001042027627091,
  0.0001072491075487,0.0001031241657325,0.0001061728492109,0.0001020174890065,
  0.0001050691521141,0.0001008831291099,0.0001039380971598,9.971977503612e-05,
  0.0001027782254214,9.852731997307e-05,0.0001015878512659,9.730332220066e-05,
  0.0001003655825159,9.604782972735e-05,9.911373810791e-05,9.476529571856e-05,
  9.783562769359e-05,9.345673492143e-05,9.653049501463e-05,9.211854414302e-05,
  9.519313410324e-05, 9.07454866753e-05,9.381853142873e-05,8.933587131986e-05,
  9.241236407815e-05, 8.78996249199e-05,9.098504089919e-05,8.644188328554e-05,
  8.952552806823e-05,8.494130024717e-05,8.802013716573e-05,8.340708440074e-05,
  8.650929858369e-05,8.186829222529e-05,8.493119442438e-05, 8.02773309533e-05,
  8.335594454577e-05,7.864908903948e-05,8.173811469998e-05,7.699469901856e-05,
   8.00850388421e-05,7.530815929866e-05, 7.84013268741e-05,7.359091751652e-05,
  7.668612873332e-05,7.184234829349e-05,  7.4938142393e-05,7.006112109431e-05,
  7.315731598104e-05,6.824555249546e-05,7.134157162437e-05,6.639551250289e-05,
  6.949251984536e-05,6.451429471506e-05,6.761426120959e-05,6.260376404063e-05,
  6.570583813104e-05,6.066164600173e-05,6.376308234899e-05,5.868322944297e-05,
  6.178253942984e-05,5.666650925698e-05,5.976587546422e-05,5.461875439002e-05,
  5.772123660912e-05,5.254413133569e-05,5.564626115476e-05,5.042898784889e-05,
   5.35264650236e-05, 4.82739449605e-05,5.137980326331e-05,4.610534163755e-05,
  4.920986407337e-05,4.387181326089e-05,4.699289686311e-05, 4.16379362388e-05,
  4.473549829037e-05,3.935579836471e-05, 4.24522435167e-05,3.703667370545e-05,
  4.013443960435e-05,3.468559661707e-05,3.778321579473e-05,3.230033918022e-05,
  3.539770864548e-05,2.987984236749e-05,3.297677124358e-05,2.742397891699e-05,
  3.051885712507e-05,2.493127374883e-05, 2.80252255256e-05, 2.24045353611e-05,
  2.549937684055e-05,1.984678540432e-05,2.294149825975e-05,1.725556433961e-05,
  2.034870750233e-05,1.462719948952e-05,1.771762047443e-05,1.196038062326e-05,
  1.504874421139e-05,9.258595643459e-06,1.234877885211e-05,6.526577395141e-06,
  9.616437333853e-06,3.758073833004e-06,6.840301182838e-06,9.469021960096e-07,
  4.030087526166e-06,-1.889389652689e-06,1.197436125617e-06,-4.761512827817e-06,
  -1.695079898862e-06,-7.674245506705e-06,-4.592632961984e-06,-1.062984046318e-05,
  -7.541912938227e-06,-1.36098721367e-05,-1.052827803163e-05,-1.662627709201e-05,
  -1.354671578129e-05,-1.967787846293e-05,-1.660089621147e-05,-2.276529857064e-05,
  -1.969149142648e-05,-2.588956616878e-05,-2.281878794907e-05,-2.905190223922e-05,
  -2.598345288406e-05,-3.224977816934e-05,-2.918206456304e-05,-3.54802946757e-05,
  -3.241313150629e-05,-3.874478521862e-05,-3.567986692198e-05,-4.204584687526e-05,
  -3.898471502224e-05,-4.538522678058e-05,-4.232708743788e-05,-4.876082849936e-05,
  -4.570318365695e-05,-5.216787872979e-05,-4.911190788098e-05,-5.561115922301e-05,
  -5.256003002346e-05,-5.909730960058e-05,-5.604674132174e-05,-6.261307459771e-05,
  -5.95599633276e-05,-6.615891195015e-05,-6.311546189603e-05,-6.975754036415e-05,
  -6.670519236375e-05,-7.336655842358e-05,-7.033928278567e-05,-7.702782226969e-05,
  -7.399555752112e-05,-8.072460774456e-05,-7.768947066496e-05,-8.445226466445e-05,
  -8.141920208397e-05,-8.821584070009e-05,-8.518470677595e-05,-9.201550100698e-05,
  -8.898701744144e-05,-9.585162870625e-05,-9.282678261029e-05,-9.97239342059e-05,
  -9.670054028003e-05,-0.0001036290391329,-0.0001006066248983,-0.0001075670240521,
  -0.0001045473562057,-0.0001115409900149,-0.0001085243433569,-0.0001155518405666,
   -0.00011253784445,-0.0001195977092105,-0.0001165851667701,  -0.0001236755965,
  -0.0001206639202579,-0.0001277872319757,-0.0001247801036087,-0.0001319375010503,
  -0.0001289351399001,-0.0001361213126442,-0.0001331167506957,-0.0001403336956228,
  -0.0001373332430637,-0.0001445888779572,-0.0001415941747388,-0.0001488723358367,
  -0.0001458704668938,-0.0001531998645875,-0.0001501962486393,-0.0001575462798065,
  -0.0001545545402296,-0.0001619304590867,-0.0001589412097682,-0.0001663492839844,
  -0.0001633625637277,-0.0001708018264334,-0.0001678181963233,-0.000175289326746,
  -0.0001723084303409,-0.0001798116709237,-0.0001768320551932,-0.0001843650266372,
  -0.0001813863921488,-0.0001889493283772,-0.0001859727844923,-0.0001935671612462,
  -0.0001905935097017,-0.0001982188276929,-0.0001952480953838,-0.0002029036039602,
  -0.0001999341814032,-0.0002076190342449,-0.0002046501616246,-0.0002123648490562,
  -0.0002093992854763,-0.000217146358451,-0.0002141834328395,-0.0002219608723211,
  -0.0002189962158715,-0.0002267998910349,-0.0002238389582694,-0.0002316750514172,
  -0.0002287206291557,-0.0002365859038469,-0.0002336257793937,-0.0002415158486996,
  -0.0002385729216429,-0.0002464895587065,-0.0002435352013771,-0.0002514918102149,
  -0.0002485343715344,-0.0002565188707213,-0.0002535654408988,-0.0002615781410092,
  -0.0002586266210469,-0.0002666685733852,-0.0002637195643183,-0.0002717901781278,
  -0.0002688432750371,-0.0002769410413307,-0.0002739941927711,-0.0002821196581389,
  -0.0002791738189395,-0.0002873280140352,-0.0002843842328678,-0.0002925671277955,
  -0.0002896244840341,-0.0002978356230176,-0.000294893469589,-0.0003031312940888,
  -0.0003001894256533,-0.0003084539454626,-0.0003055134445447,-0.0003138069653243,
  -0.0003108689333892,-0.0003191892271652,-0.000316250925934,-0.0003245954278677,
  -0.0003216556347451,-0.0003300309330755,-0.0003270941987334,-0.0003354982832713,
  -0.000332560004965,-0.0003409851082694,-0.0003380466344672,-0.0003465095039291,
  -0.0003435689199097,-0.0003520446680134,-0.0003491151550471,-0.0003576141995051,
  -0.0003546815871052,-0.0003632108664987,-0.0003602765114411,-0.0003688322434048,
  -0.0003658981137573,-0.0003744805264777,-0.0003715458015347,-0.0003801538100054,
  -0.0003772173448838,-0.0003858493813653,-0.0003829125963434,-0.0003915698808483,
  -0.0003886334194086,-0.000397316263108,-0.0003943795204193,-0.0004030867044009,
  -0.0004001492284325,-0.0004088802389064,-0.0004059408690427,-0.0004146958726866,
  -0.0004117552752534,-0.0004205351600882,-0.0004175949103238,-0.0004263992158875,
  -0.0004234564581195,-0.0004322827111588,-0.0004293370917792,-0.0004381860168977,
  -0.0004352435726526,-0.0004441172784527,-0.0004411728291492,-0.0004500674722693,
  -0.0004471177502184,-0.0004560372059229,-0.0004530933430634,-0.0004620324565038,
  -0.0004590747487321,-0.0004680462455185,-0.0004650860613535,-0.0004740742264809,
  -0.0004711178211531,-0.0004801254423988,-0.0004771673713897,-0.0004861971798594,
  -0.0004832375238675,-0.0004922880563726,-0.0004893255842106,-0.0004983960775109,
  -0.0004954301083434,-0.000504522338065,-0.0005015541970919,-0.0005106679069608,
  -0.0005076974092455,-0.000516831528995,-0.0005138576469311,-0.0005230118108612,
  -0.0005200344001724,-0.0005292076944809,-0.0005262272619054,-0.0005354204980186,
  -0.0005324375037638,-0.0005416512144045,-0.0005386642695511,-0.0005478955448026,
  -0.0005449033583343,-0.0005541534825989,-0.0005511578419901,-0.0005604309220998,
  -0.0005574318690242,-0.0005667211765809,-0.0005637170087806,-0.0005730228001542,
  -0.0005700175170429,-0.0005793459418294,-0.0005763325814537,-0.0005856694075621,
  -0.0005826603562628,-0.0005920162716926,-0.000588995305391,-0.0005983752590005,
  -0.000595347118182,-0.0006047439261852,-0.000601712027295,-0.0006111256630501,
  -0.0006080878266358,-0.0006175172031056,-0.0006144733408601,-0.000623918499968,
  -0.0006208704739532,-0.0006303323238587,-0.000627279060012,-0.0006367569477084,
  -0.0006336974844851,-0.0006431905933393,-0.0006401249622849,-0.0006496332394504,
  -0.0006465608691054,-0.0006560847374931,-0.0006530064800794,-0.0006625456163447,
  -0.0006594612670195,-0.0006690137801105,-0.0006659211076308,-0.0006754869343247,
  -0.0006723882965292,-0.0006819690899856,-0.0006788664180597,-0.0006884606628347,
  -0.0006853475141667,-0.0006949556701159,-0.0006918347933349,-0.0007014589991323,
  -0.0006983328945541,-0.000707965732163,-0.0007048255278362,-0.000714478677624,
  -0.0007113332852268,-0.0007209906584477,-0.0007178438401515,-0.0007275119462865,
  -0.0007243553180679,-0.0007340375733273,-0.000730871555074,-0.000740564679155,
  -0.0007373889847267,-0.0007470934038347,-0.0007439087676094,-0.0007536258020983,
  -0.0007504326580604,-0.0007601603905493,-0.0007569581139009,-0.0007666958742395,
  -0.0007634841017982,-0.0007732320975664, -0.00077001089752,-0.0007797685688293,
  -0.0007765383121924,-0.0007863061731741,-0.0007830660139287,-0.0007928432010729,
  -0.0007895915266101,-0.0007993765523729,-0.0007961145368535,-0.0008059098251007,
  -0.0008026384742224,-0.0008124438240101,-0.0008091611429719,-0.0008189713625658,
  -0.0008156796626957,-0.0008254984654069,-0.000822197371233,-0.0008320247227143,
  -0.0008287080375747,-0.000838539304733,-0.0008352178921952,-0.0008450591531619,
  -0.0008417179730619,-0.0008515718932257,-0.0008482190931066,-0.0008580763908615,
  -0.0008547149953613,-0.0008645767501279,-0.000861202539625,-0.0008710693766854,
  -0.0008676834720804,-0.0008775561687336,-0.000874159254454,-0.0008840374725568,
  -0.0008806273824101,-0.000890510624576,-0.0008870874266053,-0.0008969754644022,
  -0.0008935395894254,-0.0009034322555601,-0.0008999832360838,-0.0009098805968117,
  -0.0009064187401811,-0.0009163194374109,-0.0009128437392157,-0.0009227466433188,
  -0.0009192565466417,-0.0009291634079926,-0.0009256609588971,-0.0009355716084245,
  -0.0009320553485788,-0.0009419678841685,-0.0009384346037016,-0.0009483520862893,
  -0.0009448055019113,-0.0009547248701089,-0.0009511638946552,-0.0009610810729626,
  -0.0009575041860438,-0.0009674286085881,-0.0009638389644365,-0.0009737569576292,
  -0.0009701568537802,-0.0009800773990522,-0.000976457381117,-0.0009863823786338,
  -0.0009827447380862,-0.0009926689836288,-0.0009890155006111,-0.0009989405518542,
  -0.0009952716569823,-0.001005197278748,-0.001001512158146,-0.001011436232153,
  -0.001007734929499,-0.001017658090724,-0.001013940481664,-0.001023862966217,
   -0.00102012878331,-0.001030049950524,-0.001026299211267,-0.001036218978136,
   -0.00103245027626,-0.001042367569617,-0.001038580634687,-0.001048495420428,
   -0.00104469223986,-0.001054605632436,-0.001050785107904,-0.001060695013988,
  -0.001056856042925,-0.001066760966228,-0.001062906620777,-0.001072809284198,
  -0.001068934735872,-0.001078833864365,-0.001074937912617,-0.001084833428812,
  -0.001080923881954,-0.001090816106577,-0.001086881182983,-0.001096772439466,
  -0.001092821436143,-0.001102702322394,-0.001098735914927,-0.001108609936437,
   -0.00110462249999,-0.001114492126315,-0.001110485801566,-0.001120350326374,
  -0.001116324329157,-0.001126182549744,-0.001122135482207,-0.001131987845218,
  -0.001127920932787,-0.001137766955302,-0.001133680272809,-0.001143519441775,
  -0.001139412404645,-0.001149244589424,-0.001145117016099,-0.001154940776424,
  -0.001150791938686, -0.00116060761035,-0.001156437934231,-0.001166247062281,
  -0.001162056911571,-0.001171857556992,-0.001167645149947,-0.001177436971743,
  -0.001173202253312,-0.001182987401025,-0.001178731978842,-0.001188504729078,
  -0.001184228082439,-0.001193989835745,-0.001189692203979,-0.001199448638052,
  -0.001195128504168,-0.001204869629995,-0.001200530054618,-0.001210264562542,
  -0.001205896673235,-0.001215623788131,-0.001211232543335,-0.001220946470849,
  -0.001216534732277, -0.00122623790037,-0.001221803628934,-0.001231494826472,
  -0.001227037093163,-0.001236715686424,-0.001232235462668, -0.00124190268604,
  -0.001237399165565,-0.001247054636874,-0.001242527452957,-0.001252170487802,
  -0.001247619672791,-0.001257249861171, -0.00125267429135,-0.001262291139517,
  -0.001257691780499,-0.001267295691302,  -0.0012626735633,-0.001272264129085,
  -0.001267617081324,-0.001277193073592,-0.001272521631707,-0.001282083528986,
  -0.001277388784454,-0.001286936939011,-0.001282213611024,-0.001291748356067,
  -0.001287000073605, -0.00129652073289,-0.001291751164867,-0.001301255232669,
  -0.001296456329298,-0.001305947638056,-0.001301127139869,-0.001310597197403,
  -0.001305753379887,-0.001315208223825,-0.001310335796169,-0.001319777810099,
  -0.001314879605294,-0.001324305094822, -0.00131938010523,-0.001328788702695,
  -0.001323837233463,-0.001333229981553,-0.001328253067606,-0.001337628586627,
  -0.001332625667737,-0.001341983746463, -0.00133695431967,-0.001346294963804,
  -0.001341238684433,-0.001350560915315,-0.001345477776325,-0.001354782723641,
  -0.001349673127306,-0.001358960976753,-0.001353824271898,-0.001363092843132,
  -0.001357928708491,-0.001367178897666,-0.001361987906086,-0.001371219573988,
  -0.001366001419691,-0.001375210389934,-0.001369966421488,-0.001379157406762,
  -0.001373885704194,-0.001383060295323,-0.001377758711022,-0.001386910364815,
  -0.001381583676901,-0.001390718650839,-0.001385358884458,-0.001394474796938,
  -0.001389089012551,-0.001398181184161,-0.001392770875867,-0.001401842221147,
  -0.001396402533358,-0.001405452403609,-0.001399984196259,-0.001409013262055,
  -0.001403517556026,-0.001412526097635,-0.001407001306491,-0.001415988560459,
  -0.001410435041079,-0.001419400489831,-0.001413818388617,-0.001422761597558,
  -0.001417150297227,-0.001426071511893,-0.001420432305483,-0.001429331593702,
  -0.001423664143796,-0.001432540690768,-0.001426843307815,-0.001435697335082,
  -0.001429971193609,-0.001438802690422,-0.001433046995155,-0.001441855286547,
  -0.001436067646616,-0.001444854537964,-0.001439039945755,-0.001447801996959,
  -0.001441960565644,-0.001450696717431, -0.00144482332113,-0.001453538738294,
  -0.001447638343912,-0.001456325172379,-0.001450395576962,-0.001459061343742,
  -0.001453098809184,-0.001461743421564,-0.001455751084087,-0.001464368910916,
  -0.001458346937273,-0.001466940089384,-0.001460889159403,-0.001469458089988,
  -0.001463377845637,-0.001471920815445,-0.001465810784891,-0.001474328554133,
  -0.001468188391894,-0.001476680901989,-0.001470510381084,-0.001478977130669,
  -0.001472776933119,-0.001481218992102,-0.001474989031354,-0.001483405511042,
  -0.001477145249508,-0.001485534875169,-0.001479245002856,-0.001487608749519,
  -0.001481288731547,-0.001489625415016,-0.001483274916789,-0.001491583687771,
  -0.001485204731042, -0.00149348973868,-0.001487077963793,-0.001495338155072,
  -0.001488894420072,-0.001497125502824,-0.001490655045807,-0.001498860705571,
  -0.001492355839326,-0.001500534396019,-0.001494003029523,-0.001502151312801,
  -0.001495591785121,  -0.0015037129013,-0.001497119854516,-0.001505214583039,
  -0.001498591564005,-0.001506659722744,-0.001500006605113,-0.001508047169922,
  -0.001501362618123,-0.001509375435291,-0.001502660724744,-0.001510645302572,
  -0.001503900273623,-0.001511856466562,-0.001505080961745,-0.001513009597596,
  -0.001506204599419,-0.001514105206341,-0.001507269733993,-0.001515141931386,
  -0.001508275362667, -0.00151611976623,-0.001509222971421,-0.001517038408869,
  -0.001510110503563,-0.001517897085627,-0.001510938571992, -0.00151869786272,
  -0.001511711688632,-0.001519438833202,-0.001512423605761,-0.001520121305656,
   -0.00151307344881,-0.001520746169972,-0.001513668749335,-0.001521308625113,
  -0.001514201109694,-0.001521815972448,-0.001514675614454,-0.001522262102781,
  -0.001515092270522,-0.001522645913729,-0.001515448015979,-0.001522973209514,
  -0.001515745907772,-0.001523241634347,-0.001515983950222,-0.001523449318456,
  -0.001516161769499,-0.001523598065453,-0.001516280125271,-0.001523686807377,
   -0.00151633876349,   0.9984762841848, -0.00151633876349,-0.001523686807377,
  -0.001516280125271,-0.001523598065453,-0.001516161769499,-0.001523449318456,
  -0.001515983950222,-0.001523241634347,-0.001515745907772,-0.001522973209514,
  -0.001515448015979,-0.001522645913729,-0.001515092270522,-0.001522262102781,
  -0.001514675614454,-0.001521815972448,-0.001514201109694,-0.001521308625113,
  -0.001513668749335,-0.001520746169972, -0.00151307344881,-0.001520121305656,
  -0.001512423605761,-0.001519438833202,-0.001511711688632, -0.00151869786272,
  -0.001510938571992,-0.001517897085627,-0.001510110503563,-0.001517038408869,
  -0.001509222971421, -0.00151611976623,-0.001508275362667,-0.001515141931386,
  -0.001507269733993,-0.001514105206341,-0.001506204599419,-0.001513009597596,
  -0.001505080961745,-0.001511856466562,-0.001503900273623,-0.001510645302572,
  -0.001502660724744,-0.001509375435291,-0.001501362618123,-0.001508047169922,
  -0.001500006605113,-0.001506659722744,-0.001498591564005,-0.001505214583039,
  -0.001497119854516,  -0.0015037129013,-0.001495591785121,-0.001502151312801,
  -0.001494003029523,-0.001500534396019,-0.001492355839326,-0.001498860705571,
  -0.001490655045807,-0.001497125502824,-0.001488894420072,-0.001495338155072,
  -0.001487077963793, -0.00149348973868,-0.001485204731042,-0.001491583687771,
  -0.001483274916789,-0.001489625415016,-0.001481288731547,-0.001487608749519,
  -0.001479245002856,-0.001485534875169,-0.001477145249508,-0.001483405511042,
  -0.001474989031354,-0.001481218992102,-0.001472776933119,-0.001478977130669,
  -0.001470510381084,-0.001476680901989,-0.001468188391894,-0.001474328554133,
  -0.001465810784891,-0.001471920815445,-0.001463377845637,-0.001469458089988,
  -0.001460889159403,-0.001466940089384,-0.001458346937273,-0.001464368910916,
  -0.001455751084087,-0.001461743421564,-0.001453098809184,-0.001459061343742,
  -0.001450395576962,-0.001456325172379,-0.001447638343912,-0.001453538738294,
   -0.00144482332113,-0.001450696717431,-0.001441960565644,-0.001447801996959,
  -0.001439039945755,-0.001444854537964,-0.001436067646616,-0.001441855286547,
  -0.001433046995155,-0.001438802690422,-0.001429971193609,-0.001435697335082,
  -0.001426843307815,-0.001432540690768,-0.001423664143796,-0.001429331593702,
  -0.001420432305483,-0.001426071511893,-0.001417150297227,-0.001422761597558,
  -0.001413818388617,-0.001419400489831,-0.001410435041079,-0.001415988560459,
  -0.001407001306491,-0.001412526097635,-0.001403517556026,-0.001409013262055,
  -0.001399984196259,-0.001405452403609,-0.001396402533358,-0.001401842221147,
  -0.001392770875867,-0.001398181184161,-0.001389089012551,-0.001394474796938,
  -0.001385358884458,-0.001390718650839,-0.001381583676901,-0.001386910364815,
  -0.001377758711022,-0.001383060295323,-0.001373885704194,-0.001379157406762,
  -0.001369966421488,-0.001375210389934,-0.001366001419691,-0.001371219573988,
  -0.001361987906086,-0.001367178897666,-0.001357928708491,-0.001363092843132,
  -0.001353824271898,-0.001358960976753,-0.001349673127306,-0.001354782723641,
  -0.001345477776325,-0.001350560915315,-0.001341238684433,-0.001346294963804,
   -0.00133695431967,-0.001341983746463,-0.001332625667737,-0.001337628586627,
  -0.001328253067606,-0.001333229981553,-0.001323837233463,-0.001328788702695,
   -0.00131938010523,-0.001324305094822,-0.001314879605294,-0.001319777810099,
  -0.001310335796169,-0.001315208223825,-0.001305753379887,-0.001310597197403,
  -0.001301127139869,-0.001305947638056,-0.001296456329298,-0.001301255232669,
  -0.001291751164867, -0.00129652073289,-0.001287000073605,-0.001291748356067,
  -0.001282213611024,-0.001286936939011,-0.001277388784454,-0.001282083528986,
  -0.001272521631707,-0.001277193073592,-0.001267617081324,-0.001272264129085,
    -0.0012626735633,-0.001267295691302,-0.001257691780499,-0.001262291139517,
   -0.00125267429135,-0.001257249861171,-0.001247619672791,-0.001252170487802,
  -0.001242527452957,-0.001247054636874,-0.001237399165565, -0.00124190268604,
  -0.001232235462668,-0.001236715686424,-0.001227037093163,-0.001231494826472,
  -0.001221803628934, -0.00122623790037,-0.001216534732277,-0.001220946470849,
  -0.001211232543335,-0.001215623788131,-0.001205896673235,-0.001210264562542,
  -0.001200530054618,-0.001204869629995,-0.001195128504168,-0.001199448638052,
  -0.001189692203979,-0.001193989835745,-0.001184228082439,-0.001188504729078,
  -0.001178731978842,-0.001182987401025,-0.001173202253312,-0.001177436971743,
  -0.001167645149947,-0.001171857556992,-0.001162056911571,-0.001166247062281,
  -0.001156437934231, -0.00116060761035,-0.001150791938686,-0.001154940776424,
  -0.001145117016099,-0.001149244589424,-0.001139412404645,-0.001143519441775,
  -0.001133680272809,-0.001137766955302,-0.001127920932787,-0.001131987845218,
  -0.001122135482207,-0.001126182549744,-0.001116324329157,-0.001120350326374,
  -0.001110485801566,-0.001114492126315, -0.00110462249999,-0.001108609936437,
  -0.001098735914927,-0.001102702322394,-0.001092821436143,-0.001096772439466,
  -0.001086881182983,-0.001090816106577,-0.001080923881954,-0.001084833428812,
  -0.001074937912617,-0.001078833864365,-0.001068934735872,-0.001072809284198,
  -0.001062906620777,-0.001066760966228,-0.001056856042925,-0.001060695013988,
  -0.001050785107904,-0.001054605632436, -0.00104469223986,-0.001048495420428,
  -0.001038580634687,-0.001042367569617, -0.00103245027626,-0.001036218978136,
  -0.001026299211267,-0.001030049950524, -0.00102012878331,-0.001023862966217,
  -0.001013940481664,-0.001017658090724,-0.001007734929499,-0.001011436232153,
  -0.001001512158146,-0.001005197278748,-0.0009952716569823,-0.0009989405518542,
  -0.0009890155006111,-0.0009926689836288,-0.0009827447380862,-0.0009863823786338,
  -0.000976457381117,-0.0009800773990522,-0.0009701568537802,-0.0009737569576292,
  -0.0009638389644365,-0.0009674286085881,-0.0009575041860438,-0.0009610810729626,
  -0.0009511638946552,-0.0009547248701089,-0.0009448055019113,-0.0009483520862893,
  -0.0009384346037016,-0.0009419678841685,-0.0009320553485788,-0.0009355716084245,
  -0.0009256609588971,-0.0009291634079926,-0.0009192565466417,-0.0009227466433188,
  -0.0009128437392157,-0.0009163194374109,-0.0009064187401811,-0.0009098805968117,
  -0.0008999832360838,-0.0009034322555601,-0.0008935395894254,-0.0008969754644022,
  -0.0008870874266053,-0.000890510624576,-0.0008806273824101,-0.0008840374725568,
  -0.000874159254454,-0.0008775561687336,-0.0008676834720804,-0.0008710693766854,
  -0.000861202539625,-0.0008645767501279,-0.0008547149953613,-0.0008580763908615,
  -0.0008482190931066,-0.0008515718932257,-0.0008417179730619,-0.0008450591531619,
  -0.0008352178921952,-0.000838539304733,-0.0008287080375747,-0.0008320247227143,
  -0.000822197371233,-0.0008254984654069,-0.0008156796626957,-0.0008189713625658,
  -0.0008091611429719,-0.0008124438240101,-0.0008026384742224,-0.0008059098251007,
  -0.0007961145368535,-0.0007993765523729,-0.0007895915266101,-0.0007928432010729,
  -0.0007830660139287,-0.0007863061731741,-0.0007765383121924,-0.0007797685688293,
   -0.00077001089752,-0.0007732320975664,-0.0007634841017982,-0.0007666958742395,
  -0.0007569581139009,-0.0007601603905493,-0.0007504326580604,-0.0007536258020983,
  -0.0007439087676094,-0.0007470934038347,-0.0007373889847267,-0.000740564679155,
  -0.000730871555074,-0.0007340375733273,-0.0007243553180679,-0.0007275119462865,
  -0.0007178438401515,-0.0007209906584477,-0.0007113332852268,-0.000714478677624,
  -0.0007048255278362,-0.000707965732163,-0.0006983328945541,-0.0007014589991323,
  -0.0006918347933349,-0.0006949556701159,-0.0006853475141667,-0.0006884606628347,
  -0.0006788664180597,-0.0006819690899856,-0.0006723882965292,-0.0006754869343247,
  -0.0006659211076308,-0.0006690137801105,-0.0006594612670195,-0.0006625456163447,
  -0.0006530064800794,-0.0006560847374931,-0.0006465608691054,-0.0006496332394504,
  -0.0006401249622849,-0.0006431905933393,-0.0006336974844851,-0.0006367569477084,
  -0.000627279060012,-0.0006303323238587,-0.0006208704739532,-0.000623918499968,
  -0.0006144733408601,-0.0006175172031056,-0.0006080878266358,-0.0006111256630501,
  -0.000601712027295,-0.0006047439261852,-0.000595347118182,-0.0005983752590005,
  -0.000588995305391,-0.0005920162716926,-0.0005826603562628,-0.0005856694075621,
  -0.0005763325814537,-0.0005793459418294,-0.0005700175170429,-0.0005730228001542,
  -0.0005637170087806,-0.0005667211765809,-0.0005574318690242,-0.0005604309220998,
  -0.0005511578419901,-0.0005541534825989,-0.0005449033583343,-0.0005478955448026,
  -0.0005386642695511,-0.0005416512144045,-0.0005324375037638,-0.0005354204980186,
  -0.0005262272619054,-0.0005292076944809,-0.0005200344001724,-0.0005230118108612,
  -0.0005138576469311,-0.000516831528995,-0.0005076974092455,-0.0005106679069608,
  -0.0005015541970919,-0.000504522338065,-0.0004954301083434,-0.0004983960775109,
  -0.0004893255842106,-0.0004922880563726,-0.0004832375238675,-0.0004861971798594,
  -0.0004771673713897,-0.0004801254423988,-0.0004711178211531,-0.0004740742264809,
  -0.0004650860613535,-0.0004680462455185,-0.0004590747487321,-0.0004620324565038,
  -0.0004530933430634,-0.0004560372059229,-0.0004471177502184,-0.0004500674722693,
  -0.0004411728291492,-0.0004441172784527,-0.0004352435726526,-0.0004381860168977,
  -0.0004293370917792,-0.0004322827111588,-0.0004234564581195,-0.0004263992158875,
  -0.0004175949103238,-0.0004205351600882,-0.0004117552752534,-0.0004146958726866,
  -0.0004059408690427,-0.0004088802389064,-0.0004001492284325,-0.0004030867044009,
  -0.0003943795204193,-0.000397316263108,-0.0003886334194086,-0.0003915698808483,
  -0.0003829125963434,-0.0003858493813653,-0.0003772173448838,-0.0003801538100054,
  -0.0003715458015347,-0.0003744805264777,-0.0003658981137573,-0.0003688322434048,
  -0.0003602765114411,-0.0003632108664987,-0.0003546815871052,-0.0003576141995051,
  -0.0003491151550471,-0.0003520446680134,-0.0003435689199097,-0.0003465095039291,
  -0.0003380466344672,-0.0003409851082694,-0.000332560004965,-0.0003354982832713,
  -0.0003270941987334,-0.0003300309330755,-0.0003216556347451,-0.0003245954278677,
  -0.000316250925934,-0.0003191892271652,-0.0003108689333892,-0.0003138069653243,
  -0.0003055134445447,-0.0003084539454626,-0.0003001894256533,-0.0003031312940888,
  -0.000294893469589,-0.0002978356230176,-0.0002896244840341,-0.0002925671277955,
  -0.0002843842328678,-0.0002873280140352,-0.0002791738189395,-0.0002821196581389,
  -0.0002739941927711,-0.0002769410413307,-0.0002688432750371,-0.0002717901781278,
  -0.0002637195643183,-0.0002666685733852,-0.0002586266210469,-0.0002615781410092,
  -0.0002535654408988,-0.0002565188707213,-0.0002485343715344,-0.0002514918102149,
  -0.0002435352013771,-0.0002464895587065,-0.0002385729216429,-0.0002415158486996,
  -0.0002336257793937,-0.0002365859038469,-0.0002287206291557,-0.0002316750514172,
  -0.0002238389582694,-0.0002267998910349,-0.0002189962158715,-0.0002219608723211,
  -0.0002141834328395,-0.000217146358451,-0.0002093992854763,-0.0002123648490562,
  -0.0002046501616246,-0.0002076190342449,-0.0001999341814032,-0.0002029036039602,
  -0.0001952480953838,-0.0001982188276929,-0.0001905935097017,-0.0001935671612462,
  -0.0001859727844923,-0.0001889493283772,-0.0001813863921488,-0.0001843650266372,
  -0.0001768320551932,-0.0001798116709237,-0.0001723084303409,-0.000175289326746,
  -0.0001678181963233,-0.0001708018264334,-0.0001633625637277,-0.0001663492839844,
  -0.0001589412097682,-0.0001619304590867,-0.0001545545402296,-0.0001575462798065,
  -0.0001501962486393,-0.0001531998645875,-0.0001458704668938,-0.0001488723358367,
  -0.0001415941747388,-0.0001445888779572,-0.0001373332430637,-0.0001403336956228,
  -0.0001331167506957,-0.0001361213126442,-0.0001289351399001,-0.0001319375010503,
  -0.0001247801036087,-0.0001277872319757,-0.0001206639202579,  -0.0001236755965,
  -0.0001165851667701,-0.0001195977092105, -0.00011253784445,-0.0001155518405666,
  -0.0001085243433569,-0.0001115409900149,-0.0001045473562057,-0.0001075670240521,
  -0.0001006066248983,-0.0001036290391329,-9.670054028003e-05,-9.97239342059e-05,
  -9.282678261029e-05,-9.585162870625e-05,-8.898701744144e-05,-9.201550100698e-05,
  -8.518470677595e-05,-8.821584070009e-05,-8.141920208397e-05,-8.445226466445e-05,
  -7.768947066496e-05,-8.072460774456e-05,-7.399555752112e-05,-7.702782226969e-05,
  -7.033928278567e-05,-7.336655842358e-05,-6.670519236375e-05,-6.975754036415e-05,
  -6.311546189603e-05,-6.615891195015e-05,-5.95599633276e-05,-6.261307459771e-05,
  -5.604674132174e-05,-5.909730960058e-05,-5.256003002346e-05,-5.561115922301e-05,
  -4.911190788098e-05,-5.216787872979e-05,-4.570318365695e-05,-4.876082849936e-05,
  -4.232708743788e-05,-4.538522678058e-05,-3.898471502224e-05,-4.204584687526e-05,
  -3.567986692198e-05,-3.874478521862e-05,-3.241313150629e-05,-3.54802946757e-05,
  -2.918206456304e-05,-3.224977816934e-05,-2.598345288406e-05,-2.905190223922e-05,
  -2.281878794907e-05,-2.588956616878e-05,-1.969149142648e-05,-2.276529857064e-05,
  -1.660089621147e-05,-1.967787846293e-05,-1.354671578129e-05,-1.662627709201e-05,
  -1.052827803163e-05,-1.36098721367e-05,-7.541912938227e-06,-1.062984046318e-05,
  -4.592632961984e-06,-7.674245506705e-06,-1.695079898862e-06,-4.761512827817e-06,
  1.197436125617e-06,-1.889389652689e-06,4.030087526166e-06,9.469021960096e-07,
  6.840301182838e-06,3.758073833004e-06,9.616437333853e-06,6.526577395141e-06,
  1.234877885211e-05,9.258595643459e-06,1.504874421139e-05,1.196038062326e-05,
  1.771762047443e-05,1.462719948952e-05,2.034870750233e-05,1.725556433961e-05,
  2.294149825975e-05,1.984678540432e-05,2.549937684055e-05, 2.24045353611e-05,
   2.80252255256e-05,2.493127374883e-05,3.051885712507e-05,2.742397891699e-05,
  3.297677124358e-05,2.987984236749e-05,3.539770864548e-05,3.230033918022e-05,
  3.778321579473e-05,3.468559661707e-05,4.013443960435e-05,3.703667370545e-05,
   4.24522435167e-05,3.935579836471e-05,4.473549829037e-05, 4.16379362388e-05,
  4.699289686311e-05,4.387181326089e-05,4.920986407337e-05,4.610534163755e-05,
  5.137980326331e-05, 4.82739449605e-05, 5.35264650236e-05,5.042898784889e-05,
  5.564626115476e-05,5.254413133569e-05,5.772123660912e-05,5.461875439002e-05,
  5.976587546422e-05,5.666650925698e-05,6.178253942984e-05,5.868322944297e-05,
  6.376308234899e-05,6.066164600173e-05,6.570583813104e-05,6.260376404063e-05,
  6.761426120959e-05,6.451429471506e-05,6.949251984536e-05,6.639551250289e-05,
  7.134157162437e-05,6.824555249546e-05,7.315731598104e-05,7.006112109431e-05,
    7.4938142393e-05,7.184234829349e-05,7.668612873332e-05,7.359091751652e-05,
   7.84013268741e-05,7.530815929866e-05, 8.00850388421e-05,7.699469901856e-05,
  8.173811469998e-05,7.864908903948e-05,8.335594454577e-05, 8.02773309533e-05,
  8.493119442438e-05,8.186829222529e-05,8.650929858369e-05,8.340708440074e-05,
  8.802013716573e-05,8.494130024717e-05,8.952552806823e-05,8.644188328554e-05,
  9.098504089919e-05, 8.78996249199e-05,9.241236407815e-05,8.933587131986e-05,
  9.381853142873e-05, 9.07454866753e-05,9.519313410324e-05,9.211854414302e-05,
  9.653049501463e-05,9.345673492143e-05,9.783562769359e-05,9.476529571856e-05,
  9.911373810791e-05,9.604782972735e-05,0.0001003655825159,9.730332220066e-05,
  0.0001015878512659,9.852731997307e-05,0.0001027782254214,9.971977503612e-05,
  0.0001039380971598,0.0001008831291099,0.0001050691521141,0.0001020174890065,
  0.0001061728492109,0.0001031241657325,0.0001072491075487,0.0001042027627091,
  0.0001082960137196,0.0001052494349242,0.0001093174820916, 0.000106260537822,
  0.0001103050338401,0.0001072757827703,0.0001112374832801,0.0001082245933709,
  0.0001121887617536,0.0001091729558804,0.0001130923285937,0.0001100716612987,
  0.0001139611376261,0.0001109513470627,0.0001148177645211,0.0001118136695652,
  0.0001156469031412,0.0001126432248627,0.0001164399606946,0.0001134384873581,
    0.00011720303018,0.0001142072061058,0.0001179420518004,0.0001149538064152,
  0.0001186588851985,0.0001156768122222,0.0001193504812523,0.0001163720545007,
  0.0001200128907147, 0.000117038781271,0.0001206477483328,0.0001176793740527,
  0.0001212576880214,0.0001182955059157,0.0001218430338981,0.0001188886560065,
  0.0001224048598804, 0.000119457750114,0.0001229417701137,0.0001200005236258,
  0.0001234508711604,0.0001205193863994,0.0001239313483816,0.0001210076669011,
  0.0001244149940345,0.0001214410737466,0.0001248360488518,0.0001219193482426,
  0.0001252560766687,0.0001223270897484,0.0001256286645698,0.0001227169683244,
   0.000125998523802,0.0001231017780129,0.0001263507696256,0.0001234560443178,
   0.000126669150544,0.0001237768992361,0.0001269586990148,0.0001240749452302,
   0.000127228742626,0.0001243551875268,0.0001274815124837,0.0001246167879567,
  0.0001277130409519,0.0001248551095646, 0.000127919184723, 0.000125067574329,
  0.0001281011396514,0.0001252574425249,0.0001282620150229,0.0001254275224741,
  0.0001284036170681,0.0001255785258363,0.0001285273503739,0.0001257110971601,
  0.0001286311251506,0.0001258231767918,0.0001287126138984, 0.000125912780296,
  0.0001287731655975,0.0001259806945895,0.0001288072104801,0.0001260498943704,
  0.0001287911230249,0.0001260639686185,0.0001288465328997,0.0001260698266847,
  0.0001287997339097,0.0001260430407869,0.0001287641727651,0.0001260296699773,
  0.0001287252259818,0.0001259933859666,0.0001286518065872,0.0001259243851592,
  0.0001285514810015,0.0001258354860204,0.0001284379071838, 0.000125735367855,
  0.0001283130310253,0.0001256226446315,0.0001281726564907,0.0001254909704569,
  0.0001280112605013,0.0001253370620786,0.0001278281752167,0.0001251640299069,
  0.0001276279440108,0.0001249753926407,0.0001274135293376,0.0001247731998863,
  0.0001271860117678,0.0001245585866647,0.0001269453725152,0.0001243285480732,
  0.0001266891231211,0.0001240808941657,0.0001264157893872,0.0001238160546317,
  0.0001261263676207,0.0001235290474266,0.0001258353211345,0.0001232004642845,
  0.0001254984742316,0.0001229666351269,0.0001251370370148,0.0001225889714058,
  0.0001247772955322,0.0001222657611276,0.0001244375656516,0.0001219294853363,
  0.0001240625391213, 0.000121554956165,0.0001236590088925,0.0001211638184716,
  0.0001232466271862, 0.000120769516778,0.0001228303614716,0.0001203687531172,
  0.0001224041509771,0.0001199538492494,0.0001219598348071,0.0001195192980958,
  0.0001214957157831,0.0001190665835828,0.0001210165669565,0.0001186011663975,
  0.0001205261948355, 0.000118126310467, 0.000120027120242,0.0001176434639606,
  0.0001195201788499,0.0001171519492887,0.0001190018626134,0.0001166491770394,
  0.0001184703689795,0.0001161337541081,0.0001179253426871,0.0001156058860242,
  0.0001173623938319,0.0001150730216607,0.0001167692263994,0.0001145040864406,
  0.0001162873555103,0.0001138837428325,0.0001156100510599, 0.000113331706284,
  0.0001150482168927,0.0001127812306799,0.0001144463301933,0.0001121781919263,
   0.000113807007565,0.0001115576072964,0.0001131666503668,0.0001109418459992,
  0.0001125335479127, 0.000110328766715,0.0001118974811405,0.0001097072888344,
  0.0001112478589075,0.0001090684219976,0.0001105801888995,0.0001084126092966,
  0.0001098981089735, 0.000107745977517,0.0001092077737097,0.0001070727678084,
  0.0001085130589259,0.0001063962825249,0.0001078158308043,0.0001057172144683,
  0.0001071149996527,0.0001050321415008,0.0001064081930989,0.0001043397989684,
  0.0001056936589833,0.0001036391422706, 0.000104970253698,0.0001029266820006,
  0.0001042403987567,0.0001021986908753,0.0001034843197503,0.0001015907532434,
   0.000102639287742,  0.00010072646613,0.0001019864254993,0.0001000638551802,
  0.0001012591425556,9.930924489977e-05,0.0001004661257575,9.853062109103e-05,
  9.967863518121e-05,9.777326436565e-05,9.891256365315e-05,9.703352519333e-05,
  9.815489812161e-05, 9.62930588528e-05,9.738954076834e-05,9.553912172818e-05,
  9.660745604916e-05,9.476875303341e-05,9.581114793071e-05,9.398721125078e-05,
  9.500750715429e-05,9.320102619107e-05,9.420129478851e-05,9.241481977085e-05,
  9.339667568483e-05,9.163077121538e-05,9.259432375711e-05,9.084763780428e-05,
  9.179136515351e-05,9.006335096592e-05,9.098695114485e-05,8.927530388421e-05,
  9.017936204367e-05,8.848075410638e-05,8.936632289796e-05,8.767872214613e-05,
  8.855217786066e-05,8.685577012482e-05,8.785463392847e-05,8.588893986625e-05,
  8.682318281377e-05,8.535183642769e-05,8.611608603536e-05,8.451561202095e-05,
  8.522114959405e-05,8.363026329652e-05,8.433869582424e-05,8.279142765851e-05,
  8.350446869378e-05,8.199135220173e-05,8.269467272714e-05,8.120221271569e-05,
   8.18824682247e-05,  8.0403198027e-05,8.105392460079e-05,7.958578184696e-05,
  8.020782698126e-05,7.875414536189e-05,7.935051597821e-05, 7.79156176911e-05,
  7.848901943134e-05,7.707596362457e-05,7.762918482045e-05,7.624064579163e-05,
  7.677392755813e-05,7.541106862521e-05,7.592275034493e-05,7.458585404813e-05,
  7.507441882774e-05,7.376494242229e-05,7.422565826511e-05,7.294661625373e-05,
  7.337255252431e-05,7.213044102813e-05,7.251146318779e-05,7.132651947411e-05,
  7.162629364714e-05,7.062198853417e-05,7.051052826833e-05,6.947016879659e-05,
   7.03882844732e-05,6.884546692568e-05,6.926002158129e-05,6.785198757457e-05,
  6.825625166294e-05,6.696526262697e-05,6.738202765226e-05,6.616313451099e-05,
  6.657088278154e-05,6.539128406098e-05,6.577439697591e-05,6.461426257708e-05,
  6.496648166621e-05,6.381738608382e-05,6.413865019298e-05,6.300063588913e-05,
  6.329570548482e-05,6.217067629078e-05,6.244508939128e-05,6.133527558706e-05,
  6.159411906067e-05,6.050203740359e-05,6.075019216093e-05,5.967538645899e-05,
  5.991670439206e-05, 5.88568107182e-05,5.909508976116e-05,5.804656760468e-05,
  5.828691995329e-05, 5.72409620464e-05,5.749146453531e-05,5.643424188702e-05,
  5.670978146589e-05,5.561574515887e-05, 5.59509352733e-05,5.474311746044e-05,
  5.524884175831e-05,5.343918595928e-05,5.383985234492e-05, 5.54944805898e-05,
  5.343529252525e-05,5.281422056617e-05,5.220363144118e-05, 5.16646808791e-05,
  5.136966486722e-05,5.086660354889e-05,5.068045515006e-05,5.018291904661e-05,
  5.002846018464e-05,4.952357314095e-05, 4.93646360147e-05,4.884885197167e-05,
  4.866949490222e-05, 4.81440917511e-05,4.793977872207e-05,4.740936863215e-05,
  4.717897595793e-05, 4.66488454305e-05,4.639389229941e-05,4.586950399238e-05,
  4.559334179272e-05,4.507990550255e-05,4.478448516011e-05,4.428638695313e-05,
  4.397390124178e-05,4.349490070301e-05,4.316780248113e-05, 4.27107201847e-05,
  4.236910196355e-05,4.193626313007e-05,4.158103930553e-05,4.117364318028e-05,
    4.0806699088e-05,4.042505820919e-05,4.004530705363e-05, 3.96911713349e-05,
  3.929890490342e-05,3.897181528051e-05, 0.002103942351359
};


        //получается на основе загруженных коэффициентов фильтров
        const int MAX_ORDER_FILTER = 4000;
        const int CHANEL_ECG = 2; //количество каналов

        double[,] StatePBF = new double[CHANEL_ECG, MAX_ORDER_FILTER]; //состояния фильтра PassBandF
        double[,] StateLPF= new double[CHANEL_ECG,MAX_ORDER_FILTER]; //состояния фильтра LPF
        double[,] StateHPF = new double[CHANEL_ECG,MAX_ORDER_FILTER]; //состояния фильтра HPF

        //режекторный
        //double[,,] SOSOutR = new double[ORDERREJECT,CHANEL_ECG,3]; //состояния фильтра выходы
        //double[,,] SOSInR = new double[ORDERREJECT,CHANEL_ECG,3]; //состояния фильтра входы
        //HPF
        double[,,] SOSOutH = new double[ORDERHPF,CHANEL_ECG,3]; //состояния фильтра выходы
        double[,,] SOSInH = new double[ORDERHPF,CHANEL_ECG,3]; //состояния фильтра входы




        // Declare our input buffer (this has to be 128 bytes * 64 bytes)
        int numpackets = 128;

        int maxindexchanel = CHANEL_ECG-1; //максимальный номер канала
        int chanel = 0;//текущий канал 
        int bufferPointer = 1;
        private volatile bool _shouldStop = false;
        Byte G_ADC = 0x03, F_ADC = 0xA3;

        public bool ФВЧ = false;
        public bool РФ = false;
        public bool ФНЧ = false;
        public bool ПФ = false;
        public bool ФВЧ_SOS = false;


        void Filter(ref double CurrExpr, int ch)
        {
            //фильтруем
            double NewExpr;
            int i;
            int k;
            double Out;

            //1562.5 Hz

            //черновая фильтрация для визуализации
            if (ПФ)
            {
                for (i = BL_PB - 2; i >= 0; i--)
                    StatePBF[ch, i + 1] = StatePBF[ch, i];

                StatePBF[ch, 0] = CurrExpr;

                NewExpr = 0;
                //высчитываем новое значение
                for (i = 0; i < BL_PB; i++)
                {
                    NewExpr = NewExpr + StatePBF[ch, i] * B_PB[i];
                }
                CurrExpr = NewExpr; //возврат нового отфильтрованного значения

            }


            if (ФНЧ)
            {
                                
                  for(i=BL_LPF-2;i>=0;i--)
                   StateLPF[ch,i+1]=StateLPF[ch,i];

                  StateLPF[ch,0]=CurrExpr;

                  NewExpr=0;
                  //высчитываем новое значение
                  for(i=0;i<BL_LPF;i++)
                   {
                     NewExpr = NewExpr + StateLPF[ch,i]*B_LPF[i];
                   }
                  CurrExpr=NewExpr; //возврат нового отфильтрованного значения
                   
            }

            if (ФВЧ_SOS)
            {
                //ФВЧ - секции

                for (k = 0; k < ORDERHPF; k++)
                {//бегаем по секциям

                    //Direct FORM 2 IIR SOS transposed

                    //сдвигаем входы
                    SOSInH[k, ch, 2] = SOSInH[k, ch, 1];
                    SOSInH[k, ch, 1] = SOSInH[k, ch, 0];
                    //добавляем значение входа
                    SOSInH[k, ch, 0] = CurrExpr * ScaleFactorH[k];

                    //считаем секцию
                    Out = SOSInH[k, ch, 0] * SOSH[k, 0] + SOSInH[k, ch, 1] * SOSH[k, 1] + SOSInH[k, ch, 2] * SOSH[k, 2]
                            - SOSOutH[k, ch, 1] * SOSH[k, 4] - SOSOutH[k, ch, 2] * SOSH[k, 5];

                    //сдвигаем выходы
                    SOSOutH[k, ch, 2] = SOSOutH[k, ch, 1];
                    //добавляем значение входа
                    SOSOutH[k, ch, 1] = Out;

                    CurrExpr = Out; //возврат нового отфильтрованного значения
                }

            }

                if (ФВЧ)
            {
  
                for(i=BL_HPF-2;i>=0;i--)
                 StateHPF[ch,i+1]=StateHPF[ch,i];

                StateHPF[ch,0]=CurrExpr;

                NewExpr=0;
                //высчитываем новое значение
                for(i=0;i<BL_HPF;i++)
                 {
                   NewExpr = NewExpr + StateHPF[ch,i]*B_HPF[i];
                 }
                CurrExpr=NewExpr; //возврат нового отфильтрованного значения
                

            }

            if(РФ)
            { 
                /*
                //режекторный 50 Гц
                //Direct FORM 2 IIR SOS transposed
                for (k = 0; k < ORDERREJECT; k++)
                {//бегаем по секциям
                 //сдвигаем входы
                    SOSInR[k,ch,2] = SOSInR[k,ch,1];
                    SOSInR[k,ch,1] = SOSInR[k,ch,0];
                    //добавляем значение входа
                    SOSInR[k,ch,0] = CurrExpr * ScaleFactorR[k];

                    //считаем секцию
                    Out = SOSInR[k,ch,0] * SOSR[k,0] + SOSInR[k,ch,1] * SOSR[k,1] + SOSInR[k,ch,2] * SOSR[k,2]
                                    - SOSOutR[k,ch,1] * SOSR[k,4] - SOSOutR[k,ch,2] * SOSR[k,5];

                    //сдвигаем выходы
                    SOSOutR[k,ch,2] = SOSOutR[k,ch,1];
                    //добавляем значение входа
                    SOSOutR[k,ch,1] = Out;

                    CurrExpr = Out; //возврат нового отфильтрованного значения
                }
                */

            }

        }

        const int numsuperpacket = 3; //количество суперпакетов

        //функция потока
        public void DoWork()
        {
            Byte[] inputBuffer = new Byte[numpackets * 64];
            double[,] data_chanel = new double[maxindexchanel + 1, numpackets * 10 * numsuperpacket];

            while (!_shouldStop)
            {//пока не останов потока
                int xindex = 0;
                chanel = 0;

                for (int pp = 0; pp < numsuperpacket; pp++)
                {//бегаем по суперпакетам
                    // Perform the read
                    bool success = readMultipleReportsFromDevice(ref inputBuffer, numpackets);

                    // Was the read successful?
                    if (!success)
                    {
                        Debug.WriteLine("Reference Application -> Read unsuccessful!}");
                    }
                    else
                    {
                        // Test the received data
                        
                        
                        for (int packetCounter = 0; packetCounter < numpackets; packetCounter++)
                        {
                            int count_byte = 0;//количество полезных байт в пакете
                                               // Test the received data; we expect 65 bytes:
                                               // bytes 0-63 should be filled with the number of the packet
                            bufferPointer = 0;
                            do
                            {
                                if (bufferPointer == 0)
                                {//число байт в пакете без байта посылки
                                    count_byte = inputBuffer[packetCounter * 64 + bufferPointer];
                                }

                                if (bufferPointer >= 5)
                                {//берем данные АЦП
                                    int TempM, TempD, TempL, DataADC;
                                    double expr;
                                    TempM = inputBuffer[packetCounter * 64 + bufferPointer];
                                    bufferPointer++;
                                    TempD = inputBuffer[packetCounter * 64 + bufferPointer];
                                    bufferPointer++;
                                    TempL = inputBuffer[packetCounter * 64 + bufferPointer];
                                    bufferPointer++;
                                    DataADC = TempL | (TempD << 8) | (TempM << 16);
                                    if ((DataADC & 0x00800000) != 0)
                                        expr = -((double)(0x00FFFFFF - (DataADC & 0x00FFFFFF))) / (double)0x007FFFFF; //negative
                                    else
                                        expr = ((double)((DataADC & 0x00FFFFFF))) / (double)0x007FFFFF; //positive

                                    expr = expr * 2 * 2.5 / ((double)(1 << G_ADC));
                                    Filter(ref expr, chanel); //фильтруем
                                    data_chanel[chanel, xindex] = expr;

                                    // Debug.WriteLine("Rcv:" + expr.ToString()+" канал:"+chanel.ToString());
                                    if (chanel < maxindexchanel)
                                    {
                                        chanel++;//номер текущего канала
                                    }
                                    else
                                    {
                                        chanel = 0;//начинаем с нулевого канала
                                        xindex++;
                                    }

                                }
                                else
                                    bufferPointer++;
                            }
                            while (bufferPointer + 2 <= count_byte);
                            success = true;
                        }

                        
                    }

                    //отрисовка
                    if (usbEventDraw != null)
                        usbEventDraw(ref data_chanel, xindex);
                }
            }
        }


        public bool Stop()
        {
            _shouldStop = true; //на останов потока

            Thread.Sleep(5000);

            // Test 3 - Single packet write, 128 packets read
            Debug.WriteLine("Reference Application -> Stoping Test");
            // Declare our output buffer
            Byte[] outputBuffer = new Byte[64];

            outputBuffer[0] = 68; //'D'

            //стоп АЦП
            // Perform the write command
            bool success;
            success = writeSingleReportToDevice(outputBuffer);
            
            return success;
        }
        Thread myThread;

        public bool Start()
        {

            _shouldStop = false;
            myThread = new Thread(DoWork); //Создаем новый объект потока (Thread)

            // Test 3 - Single packet write, 128 packets read
            Debug.WriteLine("Reference Application -> Starting Test");
            
            // Declare our output buffer
            Byte[] outputBuffer = new Byte[64];

           

            outputBuffer[0] =  69; //'E'
            outputBuffer[1] = G_ADC;
            outputBuffer[2] = F_ADC;

            //старт АЦП
            // Perform the write command
            bool success;
            success = writeSingleReportToDevice(outputBuffer);

            // Byte 0 must be set to our command
            outputBuffer[0] = 67; //'C'

            bool success1;
            // Perform the write command
            success1 = writeSingleReportToDevice(outputBuffer);

            // Only proceed if the write was successful
            if (success && success1)
            {
                myThread.Start();//запуск потока
                success = true;
            }
            else Debug.WriteLine("Reference Application -> Write report to device failed!");

            // The data was sent and received ok!
            return success;
        }

        // Collect debug information from the device
        public String collectDebug()
            {
            // Collect debug information from USB device
            Debug.WriteLine("Reference Application -> Collecting debug information from device");

            // Declare our output buffer
            Byte[] outputBuffer = new Byte[64];

            // Declare our input buffer
            Byte[] inputBuffer = new Byte[64];

            // Byte 0 must be set to our command
            outputBuffer[0] = 0x10;

            // Send the collect debug command
            writeSingleReportToDevice(outputBuffer);

            // Read the response from the device
            readSingleReportFromDevice(ref inputBuffer);

            // Byte 0 contains the number of characters transfered
            if (inputBuffer[0] == 0) return String.Empty;

            // Sanity check the number of characters
            if (inputBuffer[0] > 63)
                {
                Debug.WriteLine("Reference Application -> Collecting debug - character counter was > 63!");
                return String.Empty;
                }

            // Convert the Byte array into a string of the correct length
            string s = System.Text.ASCIIEncoding.ASCII.GetString(inputBuffer, 1, inputBuffer[0]);

            return s;
            }
        }
    }
